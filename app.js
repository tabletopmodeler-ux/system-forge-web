let seedEl=document.getElementById('seed');let presetEl=document.getElementById('preset');let map=document.getElementById('map');let stats=document.getElementById('stats');let legend=document.getElementById('legend');let sys=null;
function rng(seed){let h=0;for(let i=0;i<seed.length;i++){h=(h*31+seed.charCodeAt(i))&0xffffffff;}return ()=>{h^=h<<13;h^=h>>17;h^=h<<5;return (h>>>0)/4294967296;}}
function gen(seed,preset){let r=rng(seed);let stars=[{id:'STAR-1',spectral_class:'G'}];let planets=[];let n=4+Math.floor(r()*4);for(let i=0;i<n;i++){let cls=['terrestrial','gas','ice'][Math.floor(r()*3)];planets.push({id:'PL-'+(i+1),class:cls,orbit_index:i+1,moons:[]});}return {seed,preset,stars,planets,system_stats:{star_count:stars.length,planet_count:planets.length}};}
function draw(sys){let ctx=map.getContext('2d');ctx.fillStyle='#0b111a';ctx.fillRect(0,0,map.width,map.height);let cx=map.width/2,cy=map.height/2;ctx.fillStyle='yellow';ctx.beginPath();ctx.arc(cx,cy,10,0,Math.PI*2);ctx.fill();let max=sys.planets.length;for(let p of sys.planets){let r=(p.orbit_index/(max+1))*250;ctx.strokeStyle='#555';ctx.beginPath();ctx.arc(cx,cy,r,0,Math.PI*2);ctx.stroke();let ang=(p.orbit_index*57)%360*Math.PI/180;let px=cx+r*Math.cos(ang),py=cy+r*Math.sin(ang);ctx.fillStyle=p.class==='g...
function generate(){sys=gen(seedEl.value,presetEl.value);draw(sys);stats.textContent='Stars:'+sys.system_stats.star_count+' Planets:'+sys.system_stats.planet_count;}
document.getElementById('btnGenerate').onclick=generate;document.getElementById('btnLegend').onclick=()=>legend.classList.toggle('hidden');document.getElementById('btnExportJSON').onclick=()=>{if(!sys)return;let blob=new Blob([JSON.stringify(sys,null,2)],{type:'application/json'});let a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='system.json';a.click();};